flexbe_cli.entity.setClientJs("element","text01",{isPure:!0});function H(t,e){e=e.sort((s,a)=>a-s);let i=e[0];return e.forEach(s=>{t<i&&t<=s&&(i=s)}),i}var q=150,T=2160,O={avif:null,webp:null};function F(){let t=typeof flexbe_cli=="object"&&flexbe_cli.vars?.site.images||{};return{lazy:!0,lazy_priority:!1,avif:!1,webp:!1,avif_support:O.avif||t.avif_support,webp_support:O.webp||t.webp_support,slow_network:!1,maxSize:T,minSize:q,quality_map:{jpg:70,webp:70,avif:55}}}async function x(t){return new Promise((e,i)=>{let s=new Image,a=()=>{e(s),setTimeout(()=>{typeof s.remove=="function"&&s.remove()},10)};"decode"in s&&!/\.svg/.test(t)?(s.src=t,s.decode().then(a).catch(i)):(s.onerror=i,s.onload=a,s.src=t)})}function at(t){if(typeof t!="string")return t;t=t.replace(/(\/img\/[\d_q]+)\/[\w-]+(\.\w{3,4})/i,"$1$2");let[,e,i,s,a]=t.match(/\/img\/(\d+)_?(\d+)?_?q?(\d+)?\.(\w{3,4})/i)||[];return{id:+e,ext:a,name:`${e}.${a}`,size:i?+i:0,quality:s?+s:null}}function W(t,e){let i=e.avif_support,s=e.webp_support,a=e.avif,o=e.webp,n=t.ext;return i&&a?n="avif":s&&o?n="webp":t.ext==="webp"&&(s?n="webp":n=t.transparent?"png":"jpg"),n}function ot(t,e=null,i=null){i={...F(),...i};let{id:s,ext:a}=t;if(!s)return"";let o=i.maxSize||T;!e&&t.ext==="webp"&&!i.webp_support&&(e=Math.min(t.width||o,o));let n=t.animated??a==="gif",r=`/img/${s}.${a}`;if(!e||n||a==="svg")return r;let c=W(t,i),d=i.slow_network&&R(),h=i.quality_map;switch(d&&(h={jpg:50,webp:50,avif:45}),c){case"png":return`/img/${s}_${e}.png`;case"avif":case"webp":case"jpg":return`/img/${s}_${e}_q${h[c]}.${c}`;case"gif":break;default:return r}}function nt(t){let e=String(t).match(/\.(jpg|jpeg|png|gif|svg|bmp|webp)$/i);return e?.[1]?e[1]:""}function rt(t){return t!=="transparent"?t:"#000000"}function lt(t){if(typeof t=="string"&&(t=at(t)),!t||typeof t!="object")return{};let e=t.img_ext||t.ext,i=t.img_id||t.id,s=t.img_name||t.name;(!e||e==="false")&&(e=s?nt(s):"jpg");let a=t.img_border||t.border,o=rt(t.img_average||t.average),n=t.img_preview||t.preview||"",r=t.img_width||t.width||0,c=t.img_height||t.height||0,d=+(+t.img_proportion||+t.proportion||0).toFixed(2),h=t.img_animated||t.animated||e==="gif",p=t.img_transparent||t.transparent||0;return{id:i,ext:e,average:o,preview:n,width:r,height:c,proportion:d,border:a,animated:h,transparent:p}}function b(t,e=0,i){return ot(lt(t),typeof e=="number"?Math.round(e):typeof e=="string"?parseInt(e,10):null,i)}async function L(t){let e=t,i=typeof t=="object"&&(+t.proportion||+t.img_proportion)||0;if(i&&(i<2||i<5&&i%1>0)&&(i*=100),typeof e=="string"||!i){typeof e=="object"&&(e=b(t,50));let s=await x(e);i=s.naturalHeight/s.naturalWidth*100}return i}function R(){return typeof navigator>"u"?!1:(navigator.connection?.effectiveType||"4g")!=="4g"}async function S(t,e,i){i={...F(),...i};let s=t.width||0,a=t.img_scale||t.scale||"cover",o=t.img_type||t.type||"background",n=e.height/e.width,r=await L(t)/100,c=i.slow_network&&R()?Math.min(1.5,globalThis.devicePixelRatio):Math.min(2,globalThis.devicePixelRatio),d=W(t,i),h,p;o==="image"||n>r&&a==="contain"||n<r&&a==="cover"?(h=e.width,p=h*r):(p=e.height,h=p/r),c>1&&(h*=c,p*=c),i.sizes&&(h=H(h,i.sizes),p=h*r);let y=i.minSize||q,v=i.maxSize||T;return h<=y&&/webp|jpg/.test(d)&&(h=h/c*2,p=h*r),s&&h>s&&(h=s,p=h*r),h>v&&(h=v,p=h*r),{width:Math.ceil(h),height:Math.ceil(p)}}var A=new WeakMap,ht=()=>Math.floor(Math.random()*999999999),U=t=>{let{is:e,component:i}=t;return A.has(i)||A.set(i,ht()),`.component-${e}-${A.get(i)}`},m=class{static is="";require=[];core=null;owner=null;root=null;component=null;$component=null;componentWidth=null;componentHeight=null;isInited=!1;isLoaded=!1;isUpdated=!1;isOpen=null;isVisible=null;inScreen=!1;inBeside=!1;inView=!1;inFocus=!1;wasVisible=null;wasScreen=!1;wasBeside=!1;wasView=!1;wasFocus=!1;get is(){return this.constructor.is}constructor({component:t,core:e,reason:i}){this.core=e,this.owner=e.area,this.root=e.root,this.component=t,this.$component=$(t),this.isUpdated=i==="update"}onInit(){}onLoad(){}onVisible(t){}onScreen(t){}onBeside(t){}onView(t){}onFocus(t){}onResize(t){}onOpen(t){}onClose(t){}onHideShowUI(t){}onDestroy(){}#e(){this._clearEvents();let t=U(this);$(this.owner).on(`tween${t}`,e=>this.#t(e.detail)),$(this.root).on(`open${t}`,e=>this._onOpen(e.detail)),$(this.root).on(`close${t}`,e=>this._onClose(e.detail))}_clearEvents(){let t=U(this);$(this.owner).off(t),$(this.root).off(t)}#t({force:t=!1}={}){let e=this.componentWidth==null||this.componentHeight==null,i=this.core.isVisible,s=i&&this.component.offsetWidth||0,a=i&&this.component.offsetHeight||0,o=!!(s||a),n=o&&this.core.inBeside,r=o&&this.core.inScreen,c=o&&this.core.inView,d=o&&this.core.inFocus,h=this.componentWidth!==s,p=this.componentHeight!==a,y=t||o&&!e&&(h||p);o&&(this.componentWidth=s,this.componentHeight=a),o!==this.isVisible&&this._onVisible({state:o}),y&&this._onResize({force:t}),n!==this.inBeside&&this._onBeside({state:n}),r!==this.inScreen&&this._onScreen({state:r}),c!==this.inView&&this._onView({state:c}),d!==this.inFocus&&this._onFocus({state:d})}_onInit(){this.isInited=!0,typeof this.onInit=="function"&&this.onInit(),this.#t(),this.#e(),flexbe_cli.require(this.require,()=>this._onLoad())}_onLoad(){this.isLoaded=!0,typeof this.onLoad=="function"&&this.onLoad(),this.require.length&&this.#t()}_onVisible({state:t}){if(this.isVisible==null){this.isVisible=t,this.wasVisible=t;return}let e=t&&!this.wasVisible;this.isVisible=t,this.onVisible({state:t,first:e}),t&&(this.wasVisible=!0)}_onScreen({state:t}){let e=t&&!this.wasScreen;this.inScreen=t,this.onScreen({state:t,first:e}),t&&(this.wasScreen=!0)}_onView({state:t}){let e=t&&!this.wasView;this.inView=t,this.onView({state:t,first:e}),t&&(this.wasView=!0)}_onBeside({state:t}){let e=t&&!this.wasBeside;this.inBeside=t,this.onBeside({state:t,first:e}),t&&(this.wasBeside=!0)}_onFocus({state:t}){let e=t&&!this.wasFocus;this.inFocus=t,this.onFocus({state:t,first:e}),t&&(this.wasFocus=!0)}_onResize(t){this.onResize(t)}_onOpen(t){this.isOpen=!0,this.#t(),this.onOpen(t)}_onClose(t){this.isOpen=!1,this.#t(),this.onClose(t)}_onWindowResize(){this.onWindowResize&&(this.#t(),this.onWindowResize())}_onHideShowUI(t){this.onHideShowUI(t)}destroy(){this._clearEvents(),this.onDestroy()}};var Ct=Object.freeze({value:"fill",title:"FILL",auto:!0,selectValue:"fill"}),Pt=Object.freeze({value:"auto",title:"AUTO",auto:!0,selectValue:"auto"}),Et=Object.freeze({value:"auto",title:"HUG",auto:!0,selectValue:"auto"}),zt=Object.freeze({value:"px",title:"PX",step:1,altStep:5}),Tt=Object.freeze({value:"pt",title:"PT",step:1,altStep:.1}),Lt=Object.freeze({value:"em",title:"EM",step:.1,altStep:.01}),At=Object.freeze({value:"rem",title:"REM",step:.1,altStep:.01}),Vt=Object.freeze({value:"vh",title:"VH",step:1,altStep:.1,tip:typeof tr=="function"&&tr("editor::units::vh_tip")}),kt=Object.freeze({value:"vw",title:"VW",step:1,altStep:.1,tip:typeof tr=="function"&&tr("editor::units::vw_tip")}),Mt=Object.freeze({value:"cqw",title:"CQW",step:1,altStep:.1}),Ht=Object.freeze({value:"cqw",title:"CQH",step:1,altStep:.1}),Ot=Object.freeze({value:"ch",title:"CH",step:1,altStep:5,tip:typeof tr=="function"&&tr("editor::units::ch_tip")}),qt=Object.freeze({value:"%",title:"%",step:1,altStep:.1});function B(t,e,i=1){let s=t.getBoundingClientRect();return{x:(e.clientX-s.left)/i,y:(e.clientY-s.top)/i}}var N=class extends m{static is="backgroundElement";constructor(...t){super(...t),this.$glareElement=this.$component.find("> .bg-glare-hover").eq(0),this.$bgElement=this.$component.find(".bg-fill").eq(0),this.$hoverElement=this.$component.find(".bg-fill-hover").eq(0),this.lazy=this.$bgElement.data("img-lazy"),this.isImgLoaded=this.$bgElement.data("img-loaded"),this.bgType=this.$bgElement.data("type"),this.hoverType=this.$hoverElement.data("hover-type"),this.hasImagePlaceholder=!!this.$bgElement.data("img-has-placeholder"),this.imageLoadingOptions=flexbe_cli.vars.site.images}async onInit(){this.$bgElement.on("setImage",async()=>{this.isVisible&&!this.isImgLoading&&!this.isImgLoaded&&(this.setImageParams(),await this.loadImage())}),this.$glareElement.length&&this.$component.off("mousemove.bg-glare").on("mousemove.bg-glare",t=>{let{x:e,y:i}=B(this.$component[0],t);this.$glareElement.css({"--bgGlareX":`${e}px`,"--bgGlareY":`${i}px`})})}async onBeside({state:t,first:e}){t&&e&&(this.lazy&&this.bgType==="image"&&!this.isImgLoaded&&(this.setImageParams(),await this.loadImage()),this.hoverType==="image"&&(this.setHoverImageParams(),await this.loadHoverImage()),this.dispatchEffects())}onWindowResize(){this.dispatchEffects()}getComponentSize(){return{width:this.componentWidth,height:this.componentHeight}}dispatchEffects(){let t=flexbe_cli.resize.responsiveMode==="mobile",e=this.$component.hasClass("hover-trigger"),i=this.$component.hasClass("hover-trigger-am"),s=t?i:e;this.$component.toggleClass("js-hover",s)}async loadImage(){this.isImgLoading=!0;let t=0;if(!this.image.original){let{width:i}=await S(this.image,this.getComponentSize(),this.imageLoadingOptions);t=i}let e=b(this.image,t,this.imageLoadingOptions);this.hasImagePlaceholder&&await x(e),this.setImage(this.$bgElement,e),this.isImgLoading=!1,this.isImgLoaded=!0}async loadHoverImage(){let t=0;if(!this.hoverImage.original){let{width:i}=await S(this.hoverImage,this.getComponentSize(),this.imageLoadingOptions);t=i}let e=b(this.hoverImage,t,this.imageLoadingOptions);this.setImage(this.$hoverElement,e)}setImage(t,e){t.css("background-image",`url(${e})`),this.$component.find(".bg-preview").eq(0).addClass("invisible")}setImageParams(){let{$bgElement:t}=this;this.image={id:t.data("img-id"),ext:t.data("img-ext"),width:t.data("img-width"),animated:t.data("img-animated"),transparent:t.data("img-transparent"),proportion:t.data("img-proportion"),original:t.is("[data-img-original]"),type:"background",scale:"cover"}}setHoverImageParams(){let{$hoverElement:t}=this;this.hoverImage={id:t.data("img-id"),ext:t.data("img-ext"),width:t.data("img-width"),animated:t.data("img-animated"),transparent:t.data("img-transparent"),proportion:t.data("img-proportion"),original:t.is("[data-img-original]"),type:"background",scale:"cover"}}};flexbe_cli.entity.setClientJs("element","zone",{components:[N],onInit(){this.setMeta()},onUpdate(){this.setMeta()},setMeta(){let t=this.lastViewport,e=this.hideHidden;this.lastViewport=flexbe_cli.resize.viewportWidth,this.hideHidden=flexbe_cli.is_admin&&$("body").hasClass("hide-hidden"),this.needFixOrder=this.needFixOrder||this.lastViewport!==t||this.hideHidden!==e},onResize(){this.inScreen&&this.isVisible&&this.fixElementOrder()},fixElementOrder(){if(this.setMeta(),!this.needFixOrder)return;this.needFixOrder=!1;let t=this.$area.find(".elements-list");t.find("[data-hidden]").length&&t.each((e,i)=>{let s=$(i).find(".element-item--static"),a=s.filter(":visible");s.removeClass("is-first-child is-last-child"),a.first().addClass("is-first-child"),a.last().addClass("is-last-child")})}});flexbe_cli.entity.setClientJs("element","zone_grid",{isPure:!0});var P=(t,e=0)=>(...i)=>new Promise(s=>{setTimeout(()=>s(t(...i)),e)}),dt=(t,e=0)=>flexbe_cli.is_admin?t:P(t,e);var j=(t,e=0,...i)=>dt(t,e)(...i),Xt=Symbol("ref");function _(t,e,i,s={}){let a=$(t),o=e?`[data-component="${e}"]`:"[data-component]";a.is(o)&&a.trigger(i,s),$(t).find(o).each((n,r)=>{$(r).trigger(i,s)})}function C(t=[]){t.forEach(P(e=>{_(e,"image","setImage")}))}var g={},D=class extends m{static is="image";isImgLoaded=!1;params=null;constructor(t){super(t),this.imageLoadingOptions=flexbe_cli.vars.site.images,this.lazyLoad=this.component.hasAttribute("data-img-lazy"),this.autoLoad=this.component.hasAttribute("data-img-autoload"),this.hasImagePlaceholder=this.component.hasAttribute("data-has-placeholder"),this.imageLayer=this.$component.find(".component-image__image").get(0)||this.component,this.overlayLayer=this.$component.find(".component-image__scroll").get(0)}async onInit(){this.autoLoad&&!this.lazyLoad&&await this.loadImage(),this.$component.off(".componentImage"),this.$component.on("setImage.componentImage",$.debounce(async t=>{t.detail?.reason==="lazyPriority"&&!this.autoLoad||(this.autoLoad=!0,this.lazyLoad=!0,this.isVisible&&!this.isImgLoading&&!this.isImgLoaded&&await this.loadImage())},10))}async onBeside({state:t}){if(!t)return!1;!this.isImgLoaded&&this.autoLoad&&await this.loadImage()}async onResize(){this.isImgLoaded&&this.autoLoad&&(clearTimeout(this._resizeTimeout),this._resizeTimeout=setTimeout(()=>this.loadImage(!0),1e3))}onHideShowUI(t){t==="generation"&&requestAnimationFrame(()=>{this.component&&this.params?.position&&(this.component.style.setProperty("--imagePositionX",this.params.position.x),this.component.style.setProperty("--imagePositionY",this.params.position.y))})}async loadImage(t=!1){if(this.setParams(),!t&&(this.isImgLoaded||this.isImgLoading))return;this.setOverlay();let e,i=this.params;i.original_resolution||(e=await this.getOptimalSize(),e&&g[this.params.id].sizes&&!g[this.params.id].sizes.includes(e)&&g[this.params.id].sizes.push(e)),this.isImgLoading=!0;let s=b(i,e,this.imageLoadingOptions);if(this.hasImagePlaceholder&&s)try{await x(s)}catch(a){console.error("Image preload error",a);return}this.setImage(s),this.isImgLoading=!1}async getOptimalSize(){let t=this.params,e=await L(t);t.proportion=e,g[this.params.id]&&(g[this.params.id].params.proportion=e);let i=this.componentWidth||this.component.offsetWidth,s=this.componentHeight||this.component.offsetHeight,{width:a}=await S(this.params,{width:i,height:s},this.imageLoadingOptions),o=a-2,n=Math.max(50,a*1.2);return a=this.getClosestSize(a,o,n),a}setImage(t){let{$component:e,params:i}=this;t&&(i.type==="image"?this.imageLayer.src=t:i.type==="background"&&(this.imageLayer.style.backgroundImage=`url(${t})`),this.isImgLoaded||(e.removeClass("loading"),this.isImgLoaded=!0),e.trigger("load"))}setOverlay(){let{overlayLayer:t,componentWidth:e,componentHeight:i}=this;if(!t)return;let s="medium";e<=200||i<=150?s="xsmall":e<=400||i<=250?s="small":e>=650&&i>=400&&(s="large"),t.setAttribute("data-size",s),t.getAttribute("data-type")==="hover"&&$(t).on("pointerenter pointerleave",a=>{let o=a.type==="pointerenter";$(t).toggleClass("hover",o)})}setParams(){if(this.params)return;let t=this.component,e=$(t),i={},s=e.attr("data-img-id");if(g[s]?.params)i={...g[s].params};else if(i.id=s,i.ext=e.attr("data-img-ext"),i.proportion=+e.attr("data-img-proportion"),i.position={x:e.attr("data-img-x")||"50%",y:e.attr("data-img-y")||"50%"},!i.ext){let a=(e.attr("data-img-name")||"image.jpg").match(/\.(\D{2,4})$/i)||[];a[1]&&i.ext!==a[1]&&(i.ext=a[1]||!1)}i.type=e.attr("data-img-type"),i.action=e.attr("data-action"),i.proportion||(i.proportion=100),i.scale=e.attr("data-img-scale")||"cover",i.original_resolution=t.hasAttribute("data-img-original"),g[i.id]||(g[i.id]={params:{...i},sizes:[]}),i.animated=t.hasAttribute("data-img-animated"),i.transparent=t.hasAttribute("data-img-transparent"),this.params=i}getClosestSize(t,e=t,i=t+10){let s=g[this.params.id].sizes||[],a,o=1/0;return s.forEach(n=>{let r=Math.abs(n-t);n>=e&&n<=i&&r<o&&(a=n,o=r)}),a??t}};function w(t,e,i){let s;return typeof e=="function"&&typeof t=="function"&&(t()?e():(i&&setTimeout(()=>{clearInterval(s),e()},i),s=setInterval(()=>{t()&&(clearInterval(s),e())},25))),()=>clearInterval(s)}function Y(t){t.params.virtualTranslate=!0,t.params.cssMode=!1,t.params.slidesPerGroup=1,t.params.spaceBetween=0,t.on("init",P(()=>{$(t.el).addClass("swiper-effect-fade")})),t.on("setTranslate",(e,i)=>{let{slides:s,size:a,slidesSizesGrid:o}=e;if(e.params.effect!=="fade"||Number.isNaN(i))return;$(e.wrapperEl).css("transform","");for(let r=0;r<s.length;r+=1){let c=e.slides.eq(r),d=-(o.slice(0,r).reduce((h,p)=>h+p,0)+i)/o[r];c.css({left:`-${r*100}%`,opacity:Math.min(Math.max(1-Math.abs(d),0),1)})}let n=!1;e.slides.transitionEnd(()=>{n||!e||e.destroyed||(n=!0,e.animating=!1,$(e.wrapperEl).trigger("transitionend"))})})}function ct(t){t.params.virtualTranslate=!0,t.params.cssMode=!0}var V="swiper-slide",G=class extends m{static is="slider";require=["/_s/lib/swiper8/dist/swiper-bundle.min.js?v847"];constructor(...t){super(...t);let{component:e}=this;this.swiper=null,this.initialSlide=0,this.index=$(e).closest("[data-item-id]").attr("data-item-id"),this.sliderEl=e.classList.contains("swiper")?e:e.querySelector(".swiper"),this.paginationEl=e.querySelector(".slider-pagination"),this.prevEl=e.querySelector('.slider-prev, [data-direction="prev"]'),this.nextEl=e.querySelector('.slider-next, [data-direction="next"]'),this.$component.on("bringIntoView",i=>{let s=this.swiper,a=$(this.sliderEl).find(`.${V}`),o=$(i.target).closest(`.${V}`),n=a.index(o);s?n!==-1&&s.slideTo(n):this.initialSlide=n}),this.setSwiperOptions()}onLoad(){this.inScreen&&!this.swiper&&this.initSwiper()}onScreen({state:t}){!t||!this.isLoaded||this.swiper||this.initSwiper()}onView({state:t}){this.isLoaded&&(t&&!this.swiper&&this.initSwiper(),this.swiper&&this.toggleAutoplay({state:t}))}onResize(){this.swiper&&(this.setSliderSize(),this.setThumbnailsSize(),this.swiper&&this.swiper.initialized&&this.swiper.update())}onDestroy(){this.destroySwiper()}onHideShowUI(t){this.setSwiperOptions(t!=="editor"),this.destroySwiper(),this.initSwiper()}setSwiperOptions(t=flexbe_cli.run.is_preview){let e=this.paginationEl&&this.paginationEl.getAttribute("data-type")||"bullets",i=this.paginationEl&&this.paginationEl.getAttribute("data-direction")||"horizontal",s=!!Number(this.$component.attr("data-loop")),a=Number(this.$component.attr("data-autoplay"));this.options={paginationType:e,direction:i,count:this.$component.attr("data-count"),loop:t&&s,autoplay:t&&a||!1,effect:this.$component.attr("data-effect")||"slide",slidesPerView:"auto"}}initSwiper(){if(this.swiper||typeof Swiper>"u")return!1;let{options:t,component:e,core:i,root:s,index:a,sliderEl:o,paginationEl:n,prevEl:r,nextEl:c}=this,d=`${i&&i.id||"-"}:${a}`,{count:h,loop:p,paginationType:y,effect:v,direction:Z}=t,M=flexbe_cli.theme_id===4,tt=this.owner.closest(".swiper-inited"),et=t.autoplay?{delay:t.autoplay*1e3,stopOnLastSlide:!p,disableOnInteraction:!1,waitForTransition:!1}:!1,I=this.initialSlide;flexbe_cli.run.is_preview||(s._sliderState?s._sliderState[d]&&(I=Math.max(0,Math.min(h-1,s._sliderState[d])||0)):s._sliderState={},s._sliderState[d]=I);let z={el:n,type:y,clickable:!0,dynamicBullets:M,dynamicMainBullets:3};y==="thumbs"&&(z.type=!1,z.el=null,this.thumbsSwiper=new Swiper(n,{cssMode:!0,loop:!1,slidesPerView:"auto",normalizeSlideIndex:!1,direction:Z}));let l=new Swiper(o,{init:!1,speed:350,nested:tt,slideClass:V,initialSlide:I,autoplay:et,pagination:z,thumbs:{swiper:this.thumbsSwiper},navigation:{prevEl:r,nextEl:c},effect:v,rewind:p,roundLengths:!0,preventInteractionOnTransition:!0,updateOnWindowResize:!1,slidesPerView:t.slidesPerView,simulateTouch:!flexbe_cli.run.isTouch&&flexbe_cli.run.is_preview,longSwipesMs:100,longSwipesRatio:.1,preloadImages:!1,touchReleaseOnEdges:!1,runCallbacksOnInit:!1});if(this.swiper=l,v==="fade"?Y(l):M&&ct(l),l.onAny((f,u)=>{l.el.dispatchEvent(new CustomEvent(`swiper:${f}`,{detail:u,bubbles:!1,cancelable:!0}))}),l.on("init",()=>{if(!l.slides)return;this.setSliderSize(),this.setThumbnailsSize(),this.swiper!=null&&this.swiper.$el.addClass("swiper-inited"),$(r).add(c).add(n).removeClass("disabled");let f=l.slides[I],u=l.visibleSlides||[l.slides[I]];this.thumbsSwiper&&this.thumbsSwiper.visibleSlides?.length&&u.push(...this.thumbsSwiper.visibleSlides),C(u),f&&_(f,!1,"sliderActivate"),this.toggleAutoplay({state:this.inView})}),this.thumbsSwiper&&this.thumbsSwiper.on("slideChange",$.debounce(f=>{C(f.visibleSlides)},50)),l.on("slideChange",$.debounce(()=>{if(!l.initialized)return;flexbe_cli.run.is_preview||(s._sliderState[d]=l.realIndex);let f=l.slides[l.previousIndex],u=l.slides[l.activeIndex],it=u&&u.getAttribute("data-type"),st=l.previousIndex<l.activeIndex?Array.from(l.slides).slice(l.activeIndex,l.activeIndex+2):Array.from(l.slides).slice(l.activeIndex-2,l.activeIndex);e.setAttribute("data-current-content",it),_(f,null,"sliderDeactivate"),_(u,null,"sliderActivate"),C(st)},50)),l.on("touchStart",()=>{$(o).addClass("swiper-in-interacting")}),l.on("touchEnd",()=>{$(o).removeClass("swiper-in-interacting")}),l.params.cssMode){let f;l.on("slideChange",()=>{clearTimeout(f),l.animating=!0,l.allowSlidePrev=!1,l.allowSlideNext=!1,f=setTimeout(()=>{l.animating=!1,l.allowSlidePrev=!0,l.allowSlideNext=!0},150)})}this.$component.off("reduceSliderControls").on("reduceSliderControls",(f,{state:u=!0})=>{this.preventAutoplay=!!u,this.preventAutoplay&&this.toggleAutoplay({state:!1})}),this.$component.off("pointerenter").one("pointerenter",()=>{let f=Array.from(l.slides||[]);C([l.activeIndex-1,l.activeIndex+1].map(u=>f.at(u)))}),this.$component.off("pointerdown wheel").on("pointerdown wheel",()=>{this.toggleAutoplay({state:!1})}),j(()=>l.init())}destroySwiper(){if(this.swiper)try{this.swiper.destroy()}catch{}finally{this.swiper=null}}toggleAutoplay({state:t}){let{swiper:e,options:i}=this;if(!e||!i.autoplay||!e.autoplay)return!1;this.preventAutoplay&&(t=!1);let s=e.autoplay.running;t&&!s&&e.autoplay.start(),!t&&s&&e.autoplay.stop()}slideTo(t,e=!0){if(!this.swiper){this.initialSlide=t;return}let i=this.swiper.params.loop;typeof this.swiper.realIndex<"u"&&this.swiper.realIndex!==t&&(i?this.swiper.slideToLoop(t,e?null:0):this.swiper.slideTo(t,e?this.swiper.params.speed:0))}setSliderSize(){let t=this.$component.find(".swiper");if(!t.length)return;let e=t[0];e.style.width="";let i=e.getBoundingClientRect().width,s=e.offsetWidth;if(i%1>0&&Math.abs(s-i)<2){e.style.width=`${Math.round(i)}px`;try{this.swiper.update()}catch{}}}setThumbnailsSize(){if(!this.thumbsSwiper||this.options.paginationType!=="thumbs")return;let t=this.options.direction==="horizontal",e=$(this.paginationEl),i=e.find(".thumb-item"),s=2,a=i.length,o=this.thumbsSwiper.params.slidesPerView;e.add(i).css({"--thumbSize":"","--thumbPad":"",width:"",height:""});let n=parseInt(i.css("--thumbPad"),10),r=t?e[0].offsetWidth:e[0].offsetHeight,c=t?i[0].offsetWidth:i[0].offsetHeight,d=Math.max(s,Math.round(r/(c+n)));a>=s&&(a===d+1||a===d-1)?d=a:o&&(o===d+1||o===d-1)&&(d=o),e.toggleClass("is-filled",a>=d),this.thumbsSwiper.params.slidesPerView=d,this.thumbsSwiper.params.spaceBetween=n,this.thumbsSwiper.update(),this.thumbsSwiper.slides.forEach(h=>{h.style.setProperty("--thumbSize",`${h.swiperSlideSize}px`)})}};var E=class{inited=!1;loaded=!1;destroyed=!1;abortController=new AbortController;constructor(t){this.options=t,this.target=t.target}async init(){this.inited=!0,await this.whenLoaded(),this.loaded=!0}destroy(){this.abortController.abort(),this.destroyed=!0}whenLoaded(t=()=>{}){return new Promise(e=>{if(this.loaded){t(),e();return}if(this.type==="video")this.loaded=!0,t(),e();else{let i=!1,s=setTimeout(()=>{this.loaded=!0,i||(i=!0,t(),e())},1e3);$(this.target).one("load",()=>{clearTimeout(s),this.loaded=!0,i||(i=!0,t(),e())})}})}async play(){}pause(){}onLoadData(){this.options.onLoadData?.()}onPlay(){this.options.onPlay?.()}onPause(t){this.options.onPause?.(t)}onError(t){this.options.onError?.(t)}},k=class extends E{type="embed";async init(){let t=this.target;if(!t)return;let e=t.getAttribute("data-src"),i=t.getAttribute("src");e&&!i&&(t.src=e),this.inited=!0,await this.whenLoaded(),this.loaded=!0}async play(){await this.whenLoaded(),this.target.contentWindow?.postMessage("play","*")}async pause(){this.target.contentWindow?.postMessage("pause","*")}},pt=class extends E{type="embed";async init(){let t=this.target,e=t.getAttribute("data-src"),i=t.getAttribute("src"),s=a=>{(a===window.YT.PlayerState.BUFFERING||a===window.YT.PlayerState.PLAYING)&&this.onLoadData(),a===window.YT.PlayerState.PLAYING?this.onPlay():(a===window.YT.PlayerState.PAUSED||a===window.YT.PlayerState.ENDED)&&this.onPause()};e&&!i&&(t.src=e),this.inited=!0,await this.whenLoaded(),flexbe_cli.require([`https://www.youtube.com/iframe_api?origin=${window.location.host}`],()=>{this.destroyed||!this.target.isConnected||w(()=>window.YT?.Player,()=>{this.ytVideo=new window.YT.Player(t,{events:{onStateChange:a=>s(a.data),onReady:()=>s(this.ytVideo.getPlayerState())}})})}),this.loaded=!0}async play(){await this.whenLoaded(),this.target.contentWindow?.postMessage('{"event":"command","func":"playVideo","args":""}',"*")}async pause(){this.target.contentWindow?.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*")}},ft=class extends E{type="embed";async init(){let t=this.target,e=t.getAttribute("data-src"),i=t.getAttribute("src");e&&!i&&(t.src=e),this.inited=!0,await this.whenLoaded(),flexbe_cli.require(["https://player.vimeo.com/api/player.js"],()=>{this.destroyed||!this.target.isConnected||(this.vPlayer=new window.Vimeo.Player(t),this.vPlayer.on("play",()=>this.onPlay()),this.vPlayer.on("pause",()=>this.onPause()))}),this.loaded=!0}async play(){await this.whenLoaded(),this.vPlayer&&this.vPlayer.play()}async pause(){this.vPlayer&&this.vPlayer.pause()}},ut=class extends k{type="embed";playerReady=!1;player;async init(){let t=this.target;if(!t)return;let e=t.src||t.dataset.src;this.inited=!0,this.loaded=!0,t.id=crypto.randomUUID();try{if(await flexbe_cli.require(["https://player.kinescope.io/latest/iframe.player.js"],null,5e3),this.destroyed||!t.isConnected)return;let i=Object.fromEntries(new URL(e).searchParams.entries());this.player=await Kinescope.IframePlayer.create(t.id,{url:e,playlist:[],behavior:{preload:"none",playsInline:!0,autoPlay:i.autoplay?"viewable":!1,autoPause:!1,localStorage:!1,loop:i.loop==="1",muted:i.muted==="1"},ui:{controls:i.controls!=="0",language:["ru","kk","be"].includes(flexbe_cli.vars.page.language)?"ru":"en"}}),this.player.on(Kinescope.IframePlayer.Events.Play,()=>this.onPlay()),this.player.on(Kinescope.IframePlayer.Events.Pause,()=>this.onPause())}catch(i){if(this.destroyed||!t||!t.isConnected)return;console.error(i),t.src!==e&&(t.src=e),await this.whenLoaded()}this.playerReady=!0}async destroy(){super.destroy(),this.player&&await this.player.destroy()}async play(){return new Promise(t=>{w(()=>this.playerReady,async()=>{await this.player?.play(),t()},7e3)})}async pause(){this.player&&await this.player.pause()}},mt=class extends E{type="video";_wasClicked=!1;async init(){let t=this.target,e=t.poster||t.dataset.poster,i=t.getAttribute("data-src"),s=t.getAttribute("src");if(t.addEventListener("error",a=>this.onError(a.error)),t.addEventListener("loadeddata",this.onLoadData.bind(this)),t.addEventListener("playing",this.onPlay.bind(this)),t.addEventListener("pause",()=>{let a=this._wasClicked||t.currentTime===t.duration;this.onPause(a)}),t.addEventListener("pointerup",this.onClick.bind(this)),e&&(this.target.poster=e),i&&!s){let a=document.createElement("source");a.addEventListener("error",o=>this.onError(o.error||o)),a.setAttribute("type","video/mp4"),a.setAttribute("src",i),t.appendChild(a),t.load()}this.inited=!0,await this.whenLoaded(),this.loaded=!0}async play(){await this.whenLoaded(),await this.target.play()}async pause(){this.target.pause()}onClick(){this.target.paused||(this._wasClicked=!0,setTimeout(()=>{this._wasClicked=!1},100))}},gt=class extends k{playerReady=!1;async init(){await super.init();let t=e=>{let i=e.data;if(typeof i=="string")try{i=JSON.parse(e.data)}catch{}e.source===this.target.contentWindow&&(["player:ready","player:changeState"].includes(i.type)&&(this.playerReady=!0),i.type==="player:changeState"&&(i.data.state==="playing"?this.onPlay():i.data.state==="paused"&&this.onPause()))};window.addEventListener("message",t,{signal:this.abortController.signal})}async play(){this.command("player:mute"),this.command("player:setCurrentTime",{time:0}),this.command("player:play")}async pause(){this.command("player:pause")}command(t,e={}){w(()=>this.loaded&&this.playerReady,()=>{this.target.contentWindow?.postMessage(JSON.stringify({type:t,data:e}),"*")})}},Q=class extends m{static is="video";constructor(...t){super(...t);let e;switch(this.$preview=this.$component.find(".component-video__preview"),this.$iframe=this.$component.find("iframe"),this.$video=this.$component.find("video.custom-video"),this.type=this.$component.data("type"),this.autoplay=!!+this.$component.data("autoplay"),this.autoInit=this.autoplay||!this.$preview.length||this.$preview.hasClass("no-image"),this.type){case"custom":e=mt;break;case"youtube":e=pt;break;case"vimeo":e=ft;break;case"kinescope":e=ut;break;case"rutube":e=gt;break;default:e=k}this.provider=new e({target:this.type==="custom"?this.$video[0]:this.$iframe[0],onPlay:this.onPlay.bind(this),onPause:this.onPause.bind(this),onError:this.onError.bind(this),onLoadData:this.onLoadData.bind(this)}),this.$preview.removeAttr("hidden"),this.$preview.on("click",async()=>{await this.#e(),await this.play(!0)}),this.$component.off("sliderActivate").on("sliderActivate",async()=>{this.preventAutoplay=!1,this.inScreen&&this.autoInit&&(await this.#e(),this.autoplay&&await this.play())}),this.$component.off("sliderDeactivate").on("sliderDeactivate",async()=>{this.preventAutoplay=!0,await this.pause()})}onDestroy(){this.provider.destroy()}async onScreen({state:t}){t?(this.autoInit&&await this.#e(),this.autoplay&&!this.preventAutoplay&&await this.play()):await this.pause()}async#e(){this.provider.inited||(this.$component.addClass("loading"),await this.provider.init(),this.$component.removeClass("loading"),this.$component.addClass("loaded"))}async play(t=!1){this.isAutoplaying=!t,this.isPaused=!1,this.$preview.off("click").addClass("preloading");try{await this.provider.play(),this.$preview.fadeOut(150,()=>{this.$preview.remove(),this.$component.removeClass("overlayed")})}catch(e){console.warn(e)}}async pause(){this.isAutoplaying=!1,this.isPaused=!0;try{await this.provider.pause()}catch{}}onPlay(){this.isPaused=!1,this.preventAutoplay=!1,!this.autoplay&&!flexbe_cli.is_admin&&flexbe_cli.resize.responsiveMode==="mobile"&&this.component.closest('[data-hidden="desktop"]')&&(this.viewportLocked=!0,flexbe_cli.resize.lockMode(!0)),(!this.autoplay||!this.isAutoplaying)&&(this.sliderAutoplayPrevented=!0,this.$component.trigger("reduceSliderControls",{state:!0}))}onPause(t=this.inScreen){this.isPaused=!0,t&&(this.preventAutoplay=!0),this.viewportLocked&&(this.viewportLocked=!1,flexbe_cli.resize.lockMode(!1)),this.sliderAutoplayPrevented&&(this.sliderAutoplayPrevented=!1,this.$component.trigger("reduceSliderControls",{state:!1}))}onError(t){console.error(t)}onLoadData(t){this.$component.addClass("started")}};flexbe_cli.entity.setClientJs("element","media01",{components:[D,Q,G]});function X(t,e,i=1){return 1-t>i&&(t=i),(1-Math.cos(Math.PI*t*e))/2}var yt=[0,"parallax","parallax-fade","zoom","zoom-return"],wt=class{imgParams={w:0,h:0,r:1,x:.5,y:.5};canvasSize={w:0,h:0,y:0};winSize={w:0,h:0};overlayOpacity=1;constructor(t,e,i="parallax",s=null){this.id=t,this.shouldRender=!1,this.mode=typeof i=="number"?yt[i]:i,this.fadeAnimation=this.mode.includes("fade"),this.parallaxFactor=this.mode.includes("fixed")?1:this.mode.includes("parallax")?.4:0,this.zoomFactor=this.mode.includes("zoom")?.2:0,this.zoomLimit=this.mode==="zoom"?.5:this.mode==="zoom-return"?1:0,this.offCanvas=document.createElement("canvas"),this.offCtx=this.offCanvas.getContext("2d",{alpha:!1}),this.component=e[0],this.canvas=this.component.querySelector("canvas"),this.overlay=this.component.querySelector(".overlay"),this.ctx=this.canvas.getContext("2d",{alpha:!1}),this.init(s),this.reflow()}init(t){!t||!t.url||(this.img=document.createElement("img"),this.img.onload=()=>{this.ready=!0,this.imgParams={w:this.img.width,h:this.img.height,r:this.img.height/this.img.width,x:+t.x.replace("%","")/100,y:+t.y.replace("%","")/100},this.dispatchEvents(),this.draw(),requestAnimationFrame(()=>{$(this.canvas).addClass("ready")})},this.img.src=t.url)}dispatchEvents(){flexbe_cli.events.off(`.bg_${this.id}`),$(window).off(`.bg_${this.id}`),$(window).on(`scroll.bg_${this.id}`,()=>{this.draw()}),$(window).on(`resize.bg_${this.id}`,()=>{this.reflow()}),flexbe_cli.is_admin&&(flexbe_cli.events.on(`entity_render:style.bg_${this.id}`,t=>{t.id===this.id&&this.reflow()}),flexbe_cli.events.on(`layout_change.bg_${this.id}`,()=>{this.reflow()}))}toggleRendering(t){this.shouldRender=t}getZoomCoords(t){let e=1;if(this.zoomFactor){let s=100-X(t*.01,2,this.zoomLimit)*100;e=1+this.zoomFactor/100*s}let i={w:0,h:0,x:0,y:0};return i.w=this.canvasSize.w*e,i.h=this.canvasSize.h*e,i.x=(i.w-this.canvas.width)/2,i.y=(i.h-this.canvasSize.h)/2,i}reflow(){let t=this.canvas.getBoundingClientRect();this.canvasSize={w:t.width,h:t.height,y:t.top+window.pageYOffset};let{viewportWidth:e,viewportHeight:i}=flexbe_cli.resize;this.winSize.h=flexbe_cli.run.is_mobile?Math.max(this.winSize.h,i):i,this.winSize.w=e,this.fadeAnimation&&(this.overlayOpacity=parseFloat(getComputedStyle(this.component).getPropertyValue("--componentBgOpacity")||1)),this.draw()}draw(){if(!this.shouldRender||!this.ready||this.pending)return;this.pending=!0;let t=flexbe_cli.scroll.latest+this.winSize.h-this.canvasSize.y,e=100-t/(this.canvasSize.h+this.winSize.h)*100;this.drawOffscreen(),this.drawCanvas(t,e),this.drawOverlay(e),this.pending=!1}drawOffscreen(){let{canvasSize:t,zoomFactor:e,winSize:i,parallaxFactor:s,imgParams:a,offCanvas:o,offCtx:n,img:r}=this,c=e?t.h:t.h+(i.h-t.h)*s,d=t.w,h=d,p=d*a.r,y=0,v=(p-c)*a.y*-1;c/d>a.r&&(h=c/a.r,p=c,y=(h-d)*a.x*-1,v=0),o.width!==d&&(o.width=d),o.height!==c&&(o.height=c),n.drawImage(r,y,v,h,p)}drawCanvas(t,e){if(this.canvas.width!==this.canvasSize.w&&(this.canvas.width=this.canvasSize.w),this.canvas.height!==this.canvasSize.h&&(this.canvas.height=this.canvasSize.h),this.zoomFactor){let i=this.getZoomCoords(e);try{this.ctx.drawImage(this.offCanvas,Math.ceil(i.x*-1),Math.ceil(t*this.parallaxFactor-this.winSize.h*this.parallaxFactor-i.y),i.w,i.h)}catch{}}else try{this.ctx.drawImage(this.offCanvas,0,Math.ceil((t-this.winSize.h)*this.parallaxFactor))}catch{}}drawOverlay(t){if(this.fadeAnimation&&this.overlay){let e=1-(1-this.overlayOpacity)*X(t*.01,2,1);this.overlay.style.setProperty("--componentBgOpacity",e)}}destroy(){this.destroyed=!0,cancelAnimationFrame(this._raf),flexbe_cli.events.off(`.bg_${this.id}`),$(window).off(`.bg_${this.id}`),$(this.canvas).removeClass("ready"),this.offCanvas?.remove(),this.img?.remove()}},vt=class{destroyed=!1;constructor(t,e,i){this.background=t,this.core=t.core,this.$component=t.$component,this.video=e,typeof i=="function"&&(this.onInited=i),this.initVideo()}initVideo(){this.$container=$('<div class="layer video-holder"></div>'),this.insertVideo(),this.video.type==="custom"?this.initMP4():this.video.type==="vimeo"?this.initVimeo():this.video.type==="youtube"?this.initYoutube():this.video.type==="kinescope"?this.initKinescope():this.initEmbed(),$(document).on(`visibilitychange.bg_effect_${this.core.id}`,()=>{this.background.onscreen&&!document.hidden&&setTimeout(()=>{this.play()},50)})}initVimeo(){let t=0,e=()=>{let i=this.vPlayer;return Promise.all([i.getVideoWidth(),i.getVideoHeight()]).then(s=>{let[a,o]=s;return a/o<2.5&&a/o>.4||t===3?{width:a,height:o}:(t+=1,e())})};flexbe_cli.require(["https://player.vimeo.com/api/player.js"],()=>{this.destroyed||(this.vPlayer=new window.Vimeo.Player(this.$videoElement[0]),e().then(i=>(this.video.width=i.width,this.video.height=i.height,this.fitToSize(),this.play(),null)).catch(()=>{}))})}initYoutube(){let t=()=>{this.yPlayer=new window.YT.Player(this.$videoElement[0],{events:{onReady:()=>{this.fitToSize(),this.play()}}})};!window.YT&&!window.onYouTubeIframeAPIReady?(window.onYouTubeIframeAPIReady=()=>{window.youtubeBGQueue.forEach(e=>e()),window.youtubeBGQueue=null,window.onYouTubeIframeAPIReady=null},window.youtubeBGQueue=[],window.youtubeBGQueue.push(t),flexbe_cli.require(["https://www.youtube.com/iframe_api"])):window.onYouTubeIframeAPIReady?window.youtubeBGQueue.push(t):t()}initKinescope(){this.fitToSize(),this.ready(),flexbe_cli.require(["https://player.kinescope.io/latest/iframe.player.js"],async()=>{this.destroyed||(this.kPlayer=await window.Kinescope.IframePlayer.create(this.$videoElement.attr("id"),{url:this.video.link,behavior:{background:!0,preload:"auto",loop:!0,muted:!0,autoPlay:"viewable",autoPause:!1}}),this.play())})}initEmbed(){this.fitToSize(),this.play()}initMP4(){this.$videoElement[0].oncanplay=()=>{this.play()},this.$videoElement[0].onloadeddata=()=>{this.video.width=this.$videoElement[0].videoWidth,this.video.height=this.$videoElement[0].videoHeight,this.fitToSize(),this.ready()}}insertVideo(){this.video.type==="custom"?(this.$videoElement=$(`<video src="${this.video.link}"
                       controlslist="nodownload"
                       loop="true"
                       muted="true"
                       autoplay="true"
                       playsinline="true"
                       disablePictureInPicture
                       disableRemotePlayback
                       pip="false"
                ></video>`),this.$videoElement[0].disablePictureInPicture=!0,this.$videoElement[0].disableRemotePlayback=!0):this.$videoElement=$(`<iframe 
                id="${crypto.randomUUID()}"
                src="${this.video.link}"
                width="${this.video.width}" 
                height="${this.video.height}" 
                allow="autoplay; encrypted-media; fullscreen; screen-wake-lock; accelerometer; clipboard-write;"
            ></iframe>`),this.$container.append(this.$videoElement),this.$component.prepend(this.$container),this.onInited&&this.onInited(this.$container)}fitToSize(){if(this.video){let t=this.$container.width(),e=this.$container.height(),i=this.video.width/this.video.height;i>t/e?this.$videoElement.css({width:`${e*i}px`,height:"100%"}):this.$videoElement.css({width:"100%",height:`${t/i}px`})}this.videoIsResized=!0}ready(){w(()=>this.videoIsResized,()=>{this.$component.addClass("video-loaded")},5e3)}play(){this.$videoElement&&this.$videoElement[0]&&this.$videoElement[0].play?(this.$videoElement[0].play(),$(document).one("touchstart.video-bg",()=>{this.$videoElement[0].play()}),this.ready()):this.video.type==="vimeo"?w(()=>this.vPlayer&&this.vPlayer.play,()=>{setTimeout(()=>{this.vPlayer.play(),this.ready()},50)},5e3):this.video.type==="youtube"?w(()=>this.yPlayer&&this.yPlayer.playVideo,()=>{this.yPlayer.playVideo(),this.ready()},5e3):this.video.type==="kinescope"?w(()=>this.kPlayer&&this.kPlayer.play,()=>{this.kPlayer.play(),this.ready()},5e3):this.ready()}pause(){this.video.type==="vimeo"&&this.vPlayer?this.vPlayer.pause():this.video.type==="youtube"&&this.yPlayer&&this.yPlayer.pauseVideo?this.yPlayer.pauseVideo():this.video.type==="kinescope"&&this.kPlayer?.pause?this.kPlayer.pause():this.$videoElement&&this.$videoElement[0]&&this.$videoElement[0].pause&&this.$videoElement[0].pause()}destroy(){this.destroyed=!0,this.pause(),this.kPlayer&&this.kPlayer.destroy(),$(document).off(`.bg_effect_${this.core.id}`)}},bt=[800,1366,1920,2160],J=class extends m{static is="background";constructor(...t){super(...t);let{$component:e}=this,i=e.data();this.data={type:i.type||"color",hasImagePlaceholder:!!i.hasPlaceholder,imageLoadingOptions:flexbe_cli.vars.site.images,isLazyLoading:!!i.lazy,isImgLoaded:!!i.loaded,effect:i.effect,effectMobile:i.effectMobile??i.effect,videoId:i.videoId||null,videoType:i.videoType||null,videoLink:i.videoLink||null,videoWidth:i.videoWidth||640,videoHeight:i.videoHeight||360,videoPreview:i.videoPreview||"color",infinityVideo:i.infinityVideo??!1,mobileVideoEnabled:i.mobileVideoEnabled||!1,videoParallaxFactor:.4},this.image={url:null,id:i.imgId,ext:i.imgExt,x:i.imgX,y:i.imgY,proportion:i.imgProportion,width:i.imgWidth,animated:i.imgAnimated,transparent:i.imgTransparent,scale:"cover",type:"background",original:!!i.imgOriginal}}async onInit(){this.data.isLazyLoading||await this.loadImage(),this.$component.on("setImage",async()=>{this.isVisible&&!this.isImgLoading&&!this.data.isImgLoaded&&await this.loadImage()})}onScreen({state:t}){this.videoInstance&&(this.data.infinityVideo||(t?this.videoInstance.play():this.videoInstance.pause())),this.onscreen=t,!(!t||this.played)&&this.playVideo()}async onBeside({state:t,first:e}){t&&e&&(await this.loadImage(),this.imageEffectInit(),this.videoEffectInit()),this.played||this.playVideo(),this.bgEffect&&(this.bgEffect.toggleRendering(t),this.bgEffect.draw())}onResize(){this.bgEffect&&requestAnimationFrame(()=>{this.bgEffect.reflow()}),this.data.type==="video"&&(this.videoInstance?(this.videoInstance.fitToSize(),this.data.effect&&this.fixHolder&&this.setParallax&&setTimeout(()=>{this.fixHolder(),this.setParallax()},100),setTimeout(()=>{this.videoInstance.fitToSize()},150)):this.fixHolder&&this.fixHolder())}async loadImage(){if(!(this.image.id&&(this.data.type==="image"||this.data.type==="video"&&this.data.videoPreview==="image")))return;this.isImgLoading=!0;let t={width:this.componentWidth||this.component.offsetWidth,height:this.componentHeight||this.component.offsetHeight},{width:e}=this.image.original?{width:0}:await S(this.image,t,{...this.data.imageLoadingOptions,sizes:bt});if(this.image.url=b(this.image,e,this.data.imageLoadingOptions),!this.data.isImgLoaded){if(this.data.hasImagePlaceholder)try{await x(this.image.url)}catch(i){console.error("Background preload error",i);return}this.setImage(this.image.url)}this.isImgLoading=!1}setImage(t){this.$component.find(".image-holder").css("background-image",`url(${t})`),this.$component.addClass("image-loaded"),this.isImgLoading=!1,this.data.isImgLoaded=!0}imageEffectInit(){if(this.data.type!=="image"||!this.data.effect||flexbe_cli.vars.globals.isScreenshot)return;let{owner:t,$component:e,data:i,image:s}=this,a=t._core?.id||t.getAttribute("data-id");typeof t._bgEffects=="object"&&t._bgEffects.destroy();let o=i.effect!=="fixed";o&&i.effectMobile==="off"&&flexbe_cli.run.is_screen_mobile&&(o=!1),o&&(this.bgEffect=new wt(a,e,i.effect,s),t._bgEffects=this.bgEffect)}videoEffectInit(){if(this.data.type!=="video"||this.data.effect!=="parallax"||flexbe_cli.vars.globals.isScreenshot)return;let t=this.$component.find(".video-holder, .image-holder"),e=this.owner._core,i=this.data,s=()=>e.tween.height+(flexbe_cli.resize.viewportHeight-e.tween.height)*i.videoParallaxFactor,a=()=>{t.css("height",`${s()}px`)},o=()=>{if(this.data.effectMobile==="off"&&flexbe_cli.run.is_screen_mobile){t.css("top","");return}let n=1-this.data.videoParallaxFactor,r=Math.floor((flexbe_cli.scroll.latest-e.tween.start)*-n)||0;t.css("top",`${r}px`)};a(),o(),e.$area.off(`fixHeaderHeight.component-bg-${e.id}`).on(`fixHeaderHeight.component-bg-${e.id}`,()=>{o()}),$(window).off(`scroll.component-bg-${e.id}`).on(`scroll.component-bg-${e.id}`,()=>{this.onscreen&&o()}),this.fixHolder=a,this.setParallax=o}playVideo(){if(flexbe_cli.run.is_screen_mobile&&!this.data.mobileVideoEnabled||flexbe_cli.vars.globals.isCriticalCss||flexbe_cli.vars.globals.isScreenshot||flexbe_cli.vars.globals.isBot)return!1;let t=this.data,e={id:t.videoId,type:t.videoType,link:t.videoLink,width:t.videoWidth,height:t.videoHeight};return this.data.type!=="video"||!e.id&&!e.link?!1:(this.played=!0,this.videoInstance||(this.videoInstance=new vt(this,e,()=>{this.videoEffectInit()})),!0)}onDestroy(){this.core.$area.off(`fixHeaderHeight.component-bg-${this.core.id}`),$(window).off(`scroll.component-bg-${this.core.id}`),this.bgEffect&&this.bgEffect.destroy(),this.videoInstance&&this.videoInstance.destroy()}};var K=class{inited=!1;interacted=!1;opts;$area;uidAttr;classContainer;activeUid;$activeTab;$activeSection;$mainContainer;$tabsContainer;$tabsList;$swiperHelper;$tabs;$sections;get isOnScreen(){if(!this.$tabsList)return!1;let{top:t,height:e}=this.$tabsList[0].getBoundingClientRect();return t>0&&t+e<flexbe_cli.resize.viewportHeight}constructor(t){if(this.opts=t,this.$area=t.$area,this.uidAttr=t.uidAttr||"data-tab-uid",this.classContainer=t.classContainer,this.initTabs(),t.activeUid)this.selectTab(t.activeUid);else if(window.location.hash){let e=window.location.hash.replace("#",""),i=$(`._anchor[name="${e}" i]`),s=i.length?i.closest("[data-id]"):$(`[data-id="${e}" i]`),a=i[0]||s[0];a&&this.selectTabFromTarget(a)}this.$area.on("bringIntoView",e=>this.selectTabFromTarget(e.target))}initTabs(){if(this.$mainContainer=this.classContainer==="self"?this.$area:this.$area.find(this.classContainer),this.$tabsContainer=this.$area.find(".container-tabs"),this.$tabsList=this.$area.find('[role="tablist"]'),this.$swiperHelper=this.$area.find(".tab-swiper-helper"),this.inited=!!this.$tabsList.length,!!this.inited&&(this.$tabs=this.$tabsList.find('[role="tab"]'),this.$sections=this.$mainContainer.find('[role="tabpanel"]'),flexbe_cli.is_admin&&this.normalizeLines(),setTimeout(()=>{this.$mainContainer.addClass("main-area--tabs-inited")},50),this.$tabsContainer.on("click",".tab",t=>{let e=$(t.currentTarget).closest(`[${this.uidAttr}]`).attr(`${this.uidAttr}`);e&&this.selectTab(e)}),this.$tabsList.on("wheel",t=>{let e=this.$tabsList[0],i=t.originalEvent.wheelDeltaX,s=t.originalEvent.wheelDeltaY;e.scrollWidth<=e.clientWidth||s<0&&e.scrollLeft===0||s>0&&e.scrollLeft===e.scrollWidth-e.clientWidth||flexbe_cli.run.is_pointer&&!i&&s&&(t.preventDefault(),e.scrollLeft+=s)}),this.$tabsList.on("touchstart",()=>{this.interacted=!0,this.destroySwipeAnimation()}),flexbe_cli.is_admin)){let t;this.$tabsContainer.on("mouseenter",".tab",e=>{e.buttons===1&&document.body.classList.contains("state--in-move")&&(clearTimeout(t),t=setTimeout(()=>{let i=$(e.target).closest(`[${this.uidAttr}]`).attr(`${this.uidAttr}`);this.selectTab(i)},700))}),this.$tabsContainer.on("mouseleave",".tab",()=>{clearTimeout(t)})}}swipeAnimationController(){if(!this.inited)return;let t=this.$tabsList[0]&&this.$tabsList[0].scrollWidth>this.$tabsList[0].clientWidth,e=this.isOnScreen;t&&e?this.initSwiperAnimation():e||this.destroySwipeAnimation()}initSwiperAnimation(){!this.$swiperHelper.hasClass("show")&&!this.interacted&&this.$swiperHelper.addClass("show")}destroySwipeAnimation(){this.$swiperHelper.hasClass("show")&&this.$swiperHelper.removeClass("show")}selectTabFromIndex(t){let e=this.$tabs.get(t);this.selectTabFromTarget(e)}selectTabFromTarget(t){let e=$(t).closest(`[${this.uidAttr}]`).attr(`${this.uidAttr}`);this.selectTab(e)}selectTab(t,{force:e}={}){if(!t||!e&&this.activeUid===t)return;this.inited||this.initTabs();let i=this.$tabs?.filter(`[${this.uidAttr}="${t}"]`)??[];if(!i.length)return;let s=this.$sections.filter(".active"),a=s[0]&&s[0].offsetTop,o=this.$sections.filter(`[${this.uidAttr}="${t}"]`);this.scrollToTab(i),this.$tabs.removeClass("active").attr("aria-selected",!1).attr("tabindex",-1),i.addClass("active").attr("aria-selected",!0).attr("tabindex",0),this.$sections.removeClass("active").prop("hidden",!0),o.addClass("active").prop("hidden",!1);let n=o[0]&&o[0].offsetTop;if(this.activeUid=t,this.$activeTab=i,this.$activeSection=o,s[0].dispatchEvent(new CustomEvent("element-become-hidden")),o[0].dispatchEvent(new CustomEvent("element-become-visible")),typeof this.opts.onSelectTab=="function"&&this.opts.onSelectTab({uid:t,$tab:i}),!flexbe_cli.run.is_mobile&&a!=null&&n!=null&&Math.abs(a-n)>0&&typeof anime<"u"){let r=this.$mainContainer,c=a-n;r.css("will-change","transform"),anime({targets:r[0],translateY:[c,0],duration:250,easing:"easeOutCubic",complete:()=>{r.css({transform:"","will-change":""})}})}}normalizeLines(){if(!this.inited)return;let t,e=this.$tabs;this.$tabsList.find(".tab-spacer").remove(),e.removeClass("first-in-line last-in-line"),e.first().addClass("first-in-line"),e.last().addClass("last-in-line"),e.each((i,s)=>{t&&t.offsetTop!==s.offsetTop&&($(s).addClass("first-in-line"),$(t).addClass("last-in-line"),$(t).after('<span class="tab-spacer"></span>')),t=s})}scrollToTab(t){if(!this.inited)return;let e=this.$tabsList,i=e[0].scrollWidth;if(i>e[0].offsetWidth){let s=t[0].offsetLeft,a=t[0].getBoundingClientRect(),o=flexbe_cli.resize.viewportWidth,n;a.width>o||a.left<20?n=s-20:a.right>o-20&&(n=s-(o-20-a.width)),n!=null&&(n=Math.max(0,Math.min(i-o,n)),e.animate({scrollLeft:n},{duration:250}))}}resetHash(){this.inited&&String(window.location.hash).replace(/^#{1,2}(tab)?/,"")===this.activeUid&&(flexbe_cli.lockPopstate=!0,window.history.replaceState(null,null,window.location.pathname),flexbe_cli.lockPopstate=!1)}};flexbe_cli.entity.setClientJs("block","BUNDLE",{components:[J],tabsController:void 0,shouldInitTabs:!0,onUpdate({templateRendered:t,reasonData:e}){t&&(this.shouldInitTabs=!0),["create","copy"].includes(e.source)&&requestAnimationFrame(()=>this.tabsController.selectTabFromIndex(e.to))},onResize(){this.tabsController&&this.tabsController.normalizeLines()},onBeside({state:t}){t&&this.shouldInitTabs&&this.createTabs()},onScreen({state:t}){this.tabsController&&(t||(this.tabsController.swipeAnimationController(),this.tabsController.resetHash()))},onFocus({state:t}){this.tabsController&&t&&this.tabsController.swipeAnimationController()},createTabs(){if(this.shouldInitTabs=!1,!this.$area.find('[role="tabpanel"]').length){this.tabsController=null;return}this.tabsController=new K({$area:this.$area,classContainer:".main-area",activeUid:this.selectedTabUid,onSelectTab:({uid:t})=>{this.selectedTabUid=t,this.updateTween()}})}});
